import os
import sqlite3
from flask import Flask, request, jsonify

app = Flask(_name_)

# =====================
# CONFIG DB (TOUJOURS EN HAUT)
# =====================
BASE_DIR = os.path.dirname(os.path.abspath(_file_))
DB_PATH = os.path.join(BASE_DIR, "data", "app.db")

# =====================
# INIT DB
# =====================
def init_db():
    data_dir = os.path.join(BASE_DIR, "data")
    os.makedirs(data_dir, exist_ok=True)

    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS users (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            username TEXT,
            password TEXT
        )
    """)
    conn.commit()
    conn.close()

# =====================
# ROUTES
# =====================
@app.route("/")
def index():
    return "API OK"

@app.route("/users", methods=["POST"])
def create_user():
    data = request.get_json()
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    cursor.execute(
        "INSERT INTO users(username, password) VALUES (?, ?)",
        (data["username"], data["password"])
    )
    conn.commit()
    conn.close()
    return jsonify({"message": "User created"}), 201

@app.route("/users", methods=["GET"])
def get_users():
    conn = sqlite3.connect(DB_PATH)
    conn.row_factory = sqlite3.Row
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM users")
    users = cursor.fetchall()
    conn.close()
    return jsonify([dict(user) for user in users]), 200

# =====================
# MAIN
# =====================
if _name_ == "_main_":
    init_db()
    app.run(debug=True)
15:59
Vous avez envoyé
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Users CRUD</title>
</head>
<body>
    <h1>Users CRUD</h1>

    <h2>Créer un utilisateur</h2>
    <input id="username" placeholder="username">
    <input id="password" placeholder="password">
    <button onclick="createUser()">Créer</button>

    <h2>Liste des utilisateurs</h2>
    <button onclick="getUsers()">Rafraîchir</button>
    <ul id="users"></ul>

    <script>
        const API_URL = "http://127.0.0.1:5000";

        function createUser() {
            fetch(${API_URL}/users, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    username: document.getElementById("username").value,
                    password: document.getElementById("password").value
                })
            }).then(() => getUsers());
        }

        function getUsers() {
            fetch(${API_URL}/users)
                .then(res => res.json())
                .then(data => {
                    const ul = document.getElementById("users");
                    ul.innerHTML = "";
                    data.forEach(user => {
                        ul.innerHTML += `
                            <li>
                                ${user.id} - ${user.username}
                                <button onclick="deleteUser(${user.id})">Supprimer</button>
                            </li>
                        `;
                    });
                });
        }

        function deleteUser(id) {
            fetch(${API_URL}/users/${id}, {
                method: "DELETE"
            }).then(() => getUsers());
        }

        getUsers();
    </script>
</body>
</html>